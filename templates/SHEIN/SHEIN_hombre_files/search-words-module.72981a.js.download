(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"0Hw+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(r("9vJY")),n=o(r("GiOC"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={sa:a.default,ga:n.default}},"17oX":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(r("i7/w")),n=o(r("M7i/"));function o(e){return e&&e.__esModule?e:{default:e}}var s=a.default.extend({template:"<search />",components:{search:n.default}}),i=document.querySelector(".j-header-search-container");t.default=i?new s({el:".j-header-search-container"}):new s},"9vJY":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(r("14Xm")),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},o=s(r("IIIG"));function s(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function a(n,o){try{var s=t[n](o),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}("next")})}}var c=gbCommonInfo.lang,u="sheinPcSearchBox",d=["sheinPcSearchSuggest","sheinPcSearchDefault","sheinPcSearchHot","shein_PC_category"],l={viewAssoc:function(e){var t=e.associationWords,r=e.currentWord,a=t,n=[];n=n.concat(a.catWord.map(function(e){return e.name}),a.word.map(function(e){return e.origin})),this.view({search_content:r,result_content:n.map(function(e,t){return"4`"+e+"`"+(t+1)}).join(",")})},firstView:function(e){var t=e.currentWord,r=e.placeholder,a=e.historyWords,n=e.hotWords,o=t,s=[],i=1;if(t&&s.push("2`"+t+"`1"),r&&!t){try{JSON.parse(sessionStorage.getItem(c+"-searchWords-default")).info.defaultwords.forEach(function(e,t){e==r&&(i=Number(t)+1)})}catch(e){}s.push("3`"+(r.name?r.name:r)+"`"+i)}s=(s=(s=s.concat(a.map(function(e,t){return"5`"+e+"`"+(t+1)}))).concat(n.map(function(e,t){return"6`"+e.name+"`"+(t+1)}))).join(","),this.view({search_content:o,result_content:s})},view:function(){var e=i(a.default.mark(function e(t){var r,s,i,c=t.search_content,l=void 0===c?"":c,h=t.result_content,f=void 0===h?"":h;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,o.default.getAbtResult({poskey:u});case 3:return s=e.sent,e.next=6,Promise.all(d.map(function(e){return o.default.getAbtResult({poskey:e})}));case 6:i=e.sent,s&&Object.keys(s).length>0&&r.push(u+"`"+s.expid+"`"+s.id),i&&Array.isArray(i)&&i.forEach(function(e,t){Object.keys(e).length>0&&r.push(d[t]+"`"+e.expid+"`"+e.id)}),s&&"boxA"==s.param&&(f=""),sa("send",{activity_name:"expose_top_site_search",activity_param:n({search_content:l,result_content:f},{abtest:r.join(",")||""})});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),click:function(){var e=i(a.default.mark(function e(t){var r,s,i,c=t.search_content,l=void 0===c?"":c,h=t.result_content,f=void 0===h?"":h;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,o.default.getAbtResult({poskey:u});case 3:return s=e.sent,e.next=6,Promise.all(d.map(function(e){return o.default.getAbtResult({poskey:e})}));case 6:i=e.sent,s&&Object.keys(s).length>0&&r.push(u+"`"+s.expid+"`"+s.id),i&&Array.isArray(i)&&i.forEach(function(e,t){Object.keys(e).length>0&&r.push(d[t]+"`"+e.expid+"`"+e.id)}),sa("send",{activity_name:"click_top_site_search",activity_param:n({search_content:l,result_content:f},{abtest:r.join(",")||""})},{beacon:1});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()};t.default=l},AniO:function(e,t,r){"use strict";r.r(t);var a=r("bO60"),n=r.n(a);for(var o in a)"default"!==o&&function(e){r.d(t,e,function(){return a[e]})}(o);t.default=n.a},GiOC:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={bindEvent:function(){$(document).on("click",".j-cancel-word",function(e){GBGaSend({category:"导航栏",action:"ClickCancelSearch"})}),$(document).on("click",".search-content .history-hot-words .hot-words ul li a",function(e){var t=$(e.target);GBGaSend({category:"导航栏",action:"ClickHotSearch",label:t.attr("title")})}),$(document).on("click",".search-content .history-hot-words .history-words-items .history-words-item a",function(e){var t=$(e.target);GBGaSend({category:"导航栏",action:"ClickRecentSearch",label:t.text()})}),$(document).on("click",".search-content .association-words-item a",function(e){var t=$(e.target);GBGaSend({category:"导航栏",action:"ClicksuggestionSearch",label:t.closest("a").attr("title")})}),$(document).on("click",".search-content .association-words-in-cat a",function(e){var t=$(e.target);GBGaSend({category:"导航栏",action:"ClicksuggestionSearch",label:t.text()})})},goToSeachDefault:function(e){GBGaSend({category:"导航栏",action:"GoToSearch-Default",label:e})},goToSeachEdit:function(e){GBGaSend({category:"导航栏",action:"GoToSearch-Edit",label:e})}};a.bindEvent(),t.default=a},Hllq:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header-search c-header-dropdown-wrapper sa_search"},[r("a",{staticClass:"iconfont icon-search j-header-icon-s",attrs:{href:"javascript:;"}}),e._v(" "),r("form",{staticClass:"search-input j-header-search she-none"},[r("div",{ref:"container",staticClass:"c-input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.currentWord,expression:"currentWord"}],ref:"input",staticClass:"input-sm j-header-search-input",attrs:{type:"search",name:"header-search",placeholder:e.placeholder&&e.placeholder.name?e.placeholder.name:e.placeholder,autocomplete:"off"},domProps:{value:e.currentWord},on:{input:function(t){t.target.composing||(e.currentWord=t.target.value)}}}),e._v(" "),r("div",{staticClass:"search-btn she-btn-black j-search-btn",class:{disabled:e.status.isFetched&&!e.currentWord&&!e.placeholder}},[r("i",{staticClass:"iconfont icon-search header1-icon-search"}),e._v(" "),r("i",{staticClass:"iconfont-critical icon-tubiaozhizuomoban header2-icon-search"})]),e._v(" "),r("div",{staticClass:"cancel-wrap"},[r("i",{directives:[{name:"show",rawName:"v-show",value:e.currentWord,expression:"currentWord"}],staticClass:"iconfont icon-clear j-cancel-word",on:{click:function(t){e.clearWord(t)}}})]),e._v(" "),r("div",{staticClass:"search-ctn j-header2-search-ctn"},[e.associationWords.word.length||e.associationWords.catWord.length||e.historyWords.length||e.hotWords.length?r("div",{staticClass:"search-content"},[e.associationWords.word.length||e.associationWords.catWord.length?r("div",{staticClass:"association-words"},[e._l(e.associationWords.catWord,function(t,a){return r("div",{key:t.name,staticClass:"association-words-in-cat"},[r("span",{},[e._v(e._s(e.language.in))]),e._v(" "),r("a",{key:a,attrs:{href:"javascript:;"},on:{click:function(r){e.goSearchPage(t,4)}}},[e._v(e._s(t.name))])])}),e._v(" "),e._l(e.associationWords.word,function(t,a){return r("div",{key:t,staticClass:"association-words-item"},[r("a",{class:{active:e.status.itemActiveIndex==a},attrs:{href:"javascript:;",index:a,title:t.origin},domProps:{innerHTML:e._s(t.transformed)},on:{click:function(r){e.goSearchPage(t.origin,4)}}})])})],2):r("div",{staticClass:"history-hot-words"},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.historyWords.length,expression:"historyWords.length"}],staticClass:"left",class:[e.hotWords.length?"":"w-100"]},[r("div",{staticClass:"history-words"},[r("div",{staticClass:"history-words-title"},[e._v(e._s(e.language.recent_search))]),e._v(" "),r("div",{staticClass:"history-words-items"},e._l(e.historyWords,function(t,a){return r("div",{key:t,staticClass:"history-words-item"},[r("a",{attrs:{href:"javascript:;"},on:{click:function(r){e.goSearchPage(t,5,a+1)}}},[e._v(e._s(t))])])})),e._v(" "),r("a",{staticClass:"history-words-clear",attrs:{href:"javascript:;"},on:{click:e.cleanHistoryWord}},[r("i",{staticClass:"iconfont icon-delate"})])])]),e._v(" "),r("div",{staticClass:"right"},[e.hotWords.length?r("div",{staticClass:"hot-words"},[r("div",{staticClass:"hot-words-title"},[e._v(e._s(e.language.hot_search))]),e._v(" "),r("ul",e._l(e.hotWords,function(t,a){return r("li",{key:t},[r("a",{staticClass:"active",attrs:{href:"javascript:;",title:t.name},on:{click:function(r){e.goSearchPage(t.value,6,a+1)}}},[t.active?r("i",{staticClass:"iconfont icon-resou_pxxiankuan"}):e._e(),e._v(" "+e._s(t.name)+" ")])])}))]):e._e()])])]):e._e()])])])])},n=[];r.d(t,"a",function(){return a}),r.d(t,"b",function(){return n})},"M7i/":function(e,t,r){"use strict";r.r(t);var a=r("Hllq"),n=r("AniO");for(var o in n)"default"!==o&&function(e){r.d(t,e,function(){return n[e]})}(o);var s=r("KHd+"),i=Object(s.a)(n.default,a.a,a.b,!1,null,null,null);t.default=i.exports},bO60:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(r("14Xm")),n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,n=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(a=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=(d(r("sEfC")),d(r("GoyQ"))),s=d(r("0Hw+")),i=d(r("IIIG")),c=r("DtyJ"),u=r("ahDk");function d(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function a(n,o){try{var s=t[n](o),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}("next")})}}var h=gbCommonInfo,f=h.lang,p=h.language,v=h.category_style_type,m=gbCommonInfo.keywords;m=SHEIN_W.htmlDecode(m);var y={suggestWordsRule:"SuggestA",defaultWordsRule:"DefaultA",hotWordsRule:"HotA"};t.default={name:"search",data:function(){return{initVal:m,status:{cleared:!1,open:!1,itemActiveIndex:-1,isSelectByKeyboard:!1,isFetched:!1},isVaildSite:!0,abtSearchWords:y,placeholder:"",currentWord:m,defaultWords:[],hotWords:[],associationWords:{catWord:[],word:[]},historyWords:[],defaultWordInterval:null,language:p}},created:function(){var e=localStorage.getItem(f+"SearchHisotryWords")||[];try{e=JSON.parse(e)}catch(e){}Array.isArray(e)&&e.length&&(e=e.map(function(e){return decodeURIComponent(e)}),this.historyWords=e.slice(0,10))},mounted:function(){this.$refs.input.value=m,this.bindEvent(),this.parseAbt(),"function"==typeof GB_deal_with_header_arrow&&GB_deal_with_header_arrow()},watch:{currentWord:function(e){(e=e&&e.trim())||(this.status.isSelectByKeyboard=!1,this.status.itemActiveIndex=-1,this.associationWords={catWord:[],word:[]})}},methods:{bindEvent:function(){var e=this,t=this;$(".j-header-search").submit(function(t){t.preventDefault();var r=void 0,a=e.currentWord;return e.currentWord?a=e.currentWord:(a=e.placeholder,r=3),a?(e.status.isSelectByKeyboard&&(r=4),e.goSearchPage(a,r)):location.href="/",!1}),$(".j-search-btn").click(function(){if(!e.currentWord&&!e.placeholder)return!1;var t=void 0,r=e.currentWord;return e.currentWord?r=e.currentWord:(r=e.placeholder,t=3),r?e.goSearchPage(r,t):location.href="/",!1}),document.onkeydown=function(e){var r=t.associationWords.word.length,a=e.keyCode;r&&(38==a?(t.status.itemActiveIndex--,t.status.isSelectByKeyboard=!0):40==a?(t.status.isSelectByKeyboard=!0,t.status.itemActiveIndex++):13!=a&&(t.status.isSelectByKeyboard=!1),t.status.isSelectByKeyboard&&(t.status.itemActiveIndex>r-1&&(t.status.itemActiveIndex=0),t.status.itemActiveIndex<=-1&&(t.status.itemActiveIndex=r-1),t.associationWords.word[t.status.itemActiveIndex]&&(t.currentWord=t.associationWords.word[t.status.itemActiveIndex].origin)))},$(document.body).on("mouseover",".association-words-item a",function(e){var r=$(e.currentTarget).attr("index");t.status.itemActiveIndex=r}).on("mouseleave",".association-words-item a",function(e){t.status.itemActiveIndex=-1}),document.querySelector(".j-header-icon-s")&&((0,c.fromEvent)(document.querySelector(".j-header-icon-s"),"click").pipe((0,u.tap)(function(t){t.stopPropagation(),$(".j-header-search").removeClass("she-none").find("input").focus(),"undefined"!=typeof S_TopBannerGA&&S_TopBannerGA.ClickSearch(),e.status.open=!0}),(0,u.mapTo)(1),(0,u.scan)(function(e,t){return e+t}),(0,u.tap)(function(t){1==t&&s.default.sa.firstView({currentWord:e.currentWord,placeholder:e.placeholder,historyWords:e.historyWords,hotWords:e.hotWords})})).subscribe(),v&&"new"==v&&(0,c.fromEvent)(document.querySelector(".j-header-search-input"),"click").pipe((0,u.tap)(function(t){"undefined"!=typeof S_TopBannerGA&&S_TopBannerGA.ClickSearch(),e.status.open=!0}),(0,u.mapTo)(1),(0,u.scan)(function(e,t){return e+t}),(0,u.tap)(function(t){1==t&&s.default.sa.firstView({currentWord:e.currentWord,placeholder:e.placeholder,historyWords:e.historyWords,hotWords:e.hotWords})})).subscribe()),$("body").click(function(t){$.contains(e.$refs.container,t.target)||e.cancel()}),(0,c.fromEvent)(this.$refs.input,"keyup").pipe((0,u.pluck)("target","value"),(0,u.map)(function(e){return e}),(0,u.debounceTime)(250),(0,u.filter)(function(t){return!!t&&!e.status.isSelectByKeyboard}),(0,u.switchMap)(function(t){return e.fetchAssociationWords(t)}),(0,u.debounceTime)(2e3),(0,u.switchMap)(function(t){return s.default.sa.viewAssoc({associationWords:e.associationWords,currentWord:e.currentWord}),[]})).subscribe(function(e){return console.log(e)}),(0,c.fromEvent)(this.$refs.input,"click").pipe((0,u.tap)(function(e){return $(e.target).focus()}),(0,u.pluck)("target","value"),(0,u.map)(function(e){return e}),(0,u.debounceTime)(250),(0,u.tap)(function(e){"undefined"!=typeof S_TopBannerGA&&S_TopBannerGA.EditSearch()}),(0,u.filter)(function(t){return!!t&&e.status.isSelectByKeyboard}),(0,u.switchMap)(function(t){return e.fetchAssociationWords(t)})).subscribe()},parseAbt:function(){var e=l(a.default.mark(function e(){var t,r,n,o,s,c=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=["sheinPcSearchSuggest","sheinPcSearchDefault","sheinPcSearchHot"],r=void 0,n=[],o="sheinPcSearchBox",e.prev=2,e.next=5,i.default.getAbtResult({poskey:o});case 5:return r=e.sent,e.next=8,Promise.all(t.map(function(e){return i.default.getAbtResult({poskey:e})}));case 8:n=e.sent,"boxA"==r.param?this.isVaildSite=!1:"boxB"==r.param&&(this.isVaildSite=!0),n[0].param&&(this.abtSearchWords.suggestWordsRule=n[0].param),n[1].param&&(this.abtSearchWords.defaultWordsRule=n[1].param),n[2].param&&(this.abtSearchWords.hotWordsRule=n[2].param),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(2);case 17:$(function(){c.isVaildSite&&c.init()}),s=[],Object.keys(r).length>0&&s.push(o+"_"+r.type),Object.keys(y).forEach(function(e,r){n[r]&&Object.keys(n[r]).length>0&&s.push(t[r]+"_"+n[r].type)}),sessionStorage.setItem("searchWordsAbtParams",JSON.stringify(s)),sessionStorage.setItem("searchWordsAbt",JSON.stringify(n));case 23:case"end":return e.stop()}},e,this,[[2,15]])}));return function(){return e.apply(this,arguments)}}(),init:function(){var e=l(a.default.mark(function e(){var t,r,o,s,i,c,u,d;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.fetchHotWords(),this.fetchDefaultWords()]);case 2:t=e.sent,this.status.isFetched=!0,r=n(t,2),o=r[0],s=r[1],0==o.code&&o.info&&(i=o.info.activityKeyword,c=o.info.defaultwords||[],i=i.map(function(e,t){return e=t<2?{value:e,name:e.name,active:!0}:{value:e,name:e.name,active:!1}}),c=c.map(function(e,t){return e=t<2?{value:e,name:e,active:!0}:{value:e,name:e,active:!1}}),this.hotWords=[].concat(i.slice(0,2),c.slice(0,2),i.slice(2,i.length),c.slice(2,c.length))),s&&0==s.code&&s.info&&(u=s.info.activityKeyword,d=s.info.defaultwords,this.defaultWords=[].concat(u,d).slice(0,10),this.placeholder=this.defaultWords[0],this.autoUpdateDefault());case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetchDefaultWords:function(){var e=this,t=sessionStorage.getItem(f+"-searchWords-default"),r={word_type:1};return new Promise(function(a,n){if(e.abtSearchWords.defaultWordsRule){try{t=JSON.parse(t)}catch(e){}t?a(t):(r.type_id=e.abtSearchWords.defaultWordsRule,$.get("/product/search/words",r,function(e){try{sessionStorage.setItem(f+"-searchWords-default",JSON.stringify(e))}catch(e){}a(e)}))}else a({})})},fetchHotWords:function(){var e=this;return new Promise(function(t,r){var a=sessionStorage.getItem(f+"-searchWords-hot"),n={word_type:2};try{a=JSON.parse(a)}catch(e){}e.abtSearchWords.hotWordsRule?a?t(a):(n.type_id=e.abtSearchWords.hotWordsRule,$.get("/product/search/words",n,function(e){try{sessionStorage.setItem(f+"-searchWords-hot",JSON.stringify(e))}catch(e){}t(e)})):t({})})},fetchAssociationWords:function(e){var t=this,r={word:e.trim()};return new Promise(function(a,n){if(!t.isVaildSite)return a(!1);t.abtSearchWords.suggestWordsRule&&r.word&&(r.type_id=t.abtSearchWords.suggestWordsRule,$.get("/product/search/associationWords",r,function(r){0==r.code&&r.info&&(r.info.word=r.info.word.map(function(t){var r=new RegExp(""+e.trim(),"i");return{origin:t,transformed:t.replace(r,'<span class="active">'+e.trim().toLocaleLowerCase()+"</span>")}}),r.info.catWord=r.info.catWord.slice(0,2),t.currentWord&&t.currentWord.trim()&&(t.associationWords=r.info),a(r))}))})},autoUpdateDefault:function(){var e=this;(0,c.interval)(1e4).subscribe(function(t){var r=t%e.defaultWords.length;e.placeholder=e.defaultWords[r],e.status.open&&!e.currentWord&&0!=t&&s.default.sa.view({search_content:e.currentWord,result_content:"3`"+(e.placeholder&&e.placeholder.name?e.placeholder.name:e.placeholder)+"`"+(r+1)})})},clearWord:function(e){this.currentWord="",this.status.cleared=!0,$(".j-header-search input").focus()},cleanHistoryWord:function(){this.historyWords.length&&(this.historyWords=[],localStorage.removeItem(f+"SearchHisotryWords"))},cancel:function(){$(".j-header-search").addClass("she-none"),this.status.open=!1,this.associationWords.word.length&&(this.associationWords={catWord:[],word:[]},this.status.itemActiveIndex=-1)},goSearchPage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=this.currentWord,n="";this.currentWord&&(n="2`"+this.currentWord+"`1");var i=this.associationWords,c=[];c=c.concat(i.catWord.map(function(e){return e.name}),i.word.map(function(e){return e.origin}));var u=void 0;switch(t){case 3:u=this.defaultWords.indexOf(this.placeholder)||0,n="3`"+(this.placeholder&&this.placeholder.name?this.placeholder.name:this.placeholder)+"`"+(u+1);break;case 4:u=c.indexOf(e.name?e.name:e)||0,n="4`"+(e.name?e.name:e)+"`"+(u+1);break;case 5:n="5`"+e+"`"+r;break;case 6:n="6`"+(e.name?e.name:e)+"`"+r}t&&sessionStorage.setItem("sa_search_result_type",t),3==t&&s.default.ga.goToSeachDefault((0,o.default)(e)?e.name:e);var d="";if(e&&(0,o.default)(e)){switch(e.page_type){case 1:d="/pdsearch/"+encodeURIComponent(e.name)+"/";break;case 2:d="/"+e.name+"-c-"+e.page_id+".html?search_redir=1";break;case 3:d="/"+e.name+"-vc-"+e.page_id+".html?search_redir=1";break;case 4:d=e.page_url,d+=d.indexOf("?")>=0?"&":"?",d+="search_redir=1"}a=e.name}else d="/pdsearch/"+encodeURIComponent(e)+"/",2==t&&s.default.ga.goToSeachEdit(e),a=e;a&&sessionStorage.setItem("sa_search_keyword",a),s.default.sa.click({search_content:a,result_content:n}),d=d.trim().replace("@","-"),this.cancel();var l={6:"HotSearch",5:"RecentSearch",4:"SuggestionSearch",3:"DefaultSearch",2:"EditSearch"};d.includes("/pdsearch/")||(d=d.includes("?")?d+"&ici="+l[t]:d+"?ici="+l[t]),location.href=d}}}}}]);
//# sourceMappingURL=search-words-module.72981a.js.map